Index: gdk-pixbuf-2.31.1/gdk-pixbuf/io-tiff.c
===================================================================
--- gdk-pixbuf-2.31.1.orig/gdk-pixbuf/io-tiff.c	2019-12-18 23:00:04.204692656 +0100
+++ gdk-pixbuf-2.31.1/gdk-pixbuf/io-tiff.c	2019-12-18 23:00:04.200692455 +0100
@@ -118,18 +118,18 @@
                                      _("Width or height of TIFF image is zero"));
                 return NULL;                
         }
-        
-        rowstride = width * 4;
-        if (rowstride / 4 != width) { /* overflow */
+
+        if (width > G_MAXINT / 4) { /* overflow */
                 g_set_error_literal (error,
                                      GDK_PIXBUF_ERROR,
                                      GDK_PIXBUF_ERROR_CORRUPT_IMAGE,
                                      _("Dimensions of TIFF image too large"));
                 return NULL;                
         }
-        
-        bytes = height * rowstride;
-        if (bytes / rowstride != height) { /* overflow */
+
+        rowstride = width * 4;
+
+        if (height > G_MAXINT / rowstride) { /* overflow */
                 g_set_error_literal (error,
                                      GDK_PIXBUF_ERROR,
                                      GDK_PIXBUF_ERROR_CORRUPT_IMAGE,
@@ -137,6 +137,8 @@
                 return NULL;                
         }
 
+        bytes = height * rowstride;
+
 	if (context && context->size_func) {
                 gint w = width;
                 gint h = height;

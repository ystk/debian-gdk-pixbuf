Index: gdk-pixbuf-2.31.1/gdk-pixbuf/io-icns.c
===================================================================
--- gdk-pixbuf-2.31.1.orig/gdk-pixbuf/io-icns.c	2019-12-18 20:01:30.499585821 +0100
+++ gdk-pixbuf-2.31.1/gdk-pixbuf/io-icns.c	2019-12-18 20:01:30.487585225 +0100
@@ -84,7 +84,8 @@
       blocklen = GUINT32_FROM_BE (header->size);
 
       /* Check that blocklen isn't garbage */
-      if (blocklen > icnslen - (current - bytes))
+      if (blocklen > icnslen - (current - bytes) ||
+	  blocklen < sizeof (IcnsBlockHeader))
         return FALSE;
 
       switch (size)
